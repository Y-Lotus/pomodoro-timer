<!DOCTYPE html>
<html lang="en" class="">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pomodoro Timer</title>
  <link rel="shortcut icon" href="lotusicondark.png" type="image/x-icon">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }
    .btn {
      width: 170px;
      height: 60px;
      font-size: 18px;
      background: #073b4c;
      border: none;
      border-radius: 50px;
      color: #ffffff;
      cursor: pointer;
      transition: all 0.4s;
    }
    .btn:hover {
      box-shadow: inset 0 0 0 4px #ef476f, 
                  inset 0 0 0 8px #ffd166, 
                  inset 0 0 0 12px #06d6a0,
                  inset 0 0 0 16px #118ab2;
      background: #073b4c;
      color: #fff;
    }
  </style>
</head>
<body class="min-h-screen bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 flex flex-col items-center py-10 px-4 sm:px-6 lg:px-8 transition-colors duration-500">


  <main class="w-full max-w-3xl">
    <section id="pomodoro-app-section" class="p-6 bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-sm mx-auto text-center transition-colors duration-500">
      <h2 class="text-3xl font-bold text-gray-800 dark:text-gray-100 mb-6">Pomodoro Timer</h2>

      <div class="mb-6">
        <p id="pomodoro-session-type" class="text-xl text-gray-600 dark:text-gray-300 mb-2">Work Session</p>
        <div id="pomodoro-display" class="text-7xl font-mono font-bold text-gray-900 dark:text-gray-100 bg-gray-100 dark:bg-gray-700 p-6 rounded-lg shadow-inner inline-block">
          25:00
        </div>
      </div>
      
      <div class="flex justify-center space-x-4 mb-6">
        <button id="pomodoro-start" class="btn">Start</button>
        <button id="pomodoro-pause" class="btn" disabled>Pause</button>
        <button id="pomodoro-reset" class="btn">Reset</button>
      </div>
      
      <div class="mt-8 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600">
        <h3 class="text-xl font-semibold text-gray-700 dark:text-gray-200 mb-4">Settings</h3>
        <div class="flex flex-col sm:flex-row justify-center items-center space-y-4 sm:space-y-0 sm:space-x-8">
          <div class="flex items-center space-x-2">
            <label for="work-duration-input" class="text-gray-600 dark:text-gray-300">Work (min):</label>
            <input id="work-duration-input" type="number" min="1" value="25" class="w-20 p-2 border border-gray-300 dark:border-gray-500 rounded-md text-center focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-800 dark:text-gray-100"/>
          </div>
          <div class="flex items-center space-x-2">
            <label for="break-duration-input" class="text-gray-600 dark:text-gray-300">Break (min):</label>
            <input id="break-duration-input" type="number" min="1" value="5" class="w-20 p-2 border border-gray-300 dark:border-gray-500 rounded-md text-center focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-800 dark:text-gray-100"/>
          </div>
        </div>
      </div>

      <!-- History Section -->
      <div id="pomodoro-history" class="mt-8 p-4 bg-gray-100 dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 text-left max-h-40 overflow-y-auto">
        <div class="flex justify-between items-center mb-2">
          <h3 class="text-lg font-semibold">History</h3>
          <button id="clear-history" class="text-sm px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600">Clear</button>
        </div>
        <ul id="history-list" class="space-y-1 text-sm text-gray-700 dark:text-gray-300">
          <!-- GeÃ§miÅŸ oturumlar buraya eklenecek -->
        </ul>
      </div>
    </section>
  </main>

  <!-- ðŸ”” Alarm sesi -->
  <audio id="alarm-sound" src="alarm.mp3" preload="auto"></audio>

  <script>
    const pomodoroDisplay = document.getElementById('pomodoro-display');
    const pomodoroSessionType = document.getElementById('pomodoro-session-type');
    const pomodoroStartBtn = document.getElementById('pomodoro-start');
    const pomodoroPauseBtn = document.getElementById('pomodoro-pause');
    const pomodoroResetBtn = document.getElementById('pomodoro-reset');
    const workDurationInput = document.getElementById('work-duration-input');
    const breakDurationInput = document.getElementById('break-duration-input');
    const historyList = document.getElementById('history-list');
    const clearHistoryBtn = document.getElementById('clear-history');
    const alarmSound = document.getElementById('alarm-sound');

    let pomodoroMinutes = 25;
    let pomodoroSeconds = 0;
    let pomodoroIsActive = false;
    let pomodoroIsWorkSession = true;
    let pomodoroTimerInterval = null;
    let configuredWorkDuration = 25;
    let configuredBreakDuration = 5;

    function formatTime(num) {
      return String(num).padStart(2, '0');
    }

    function updatePomodoroDisplay() {
      pomodoroDisplay.textContent = `${formatTime(pomodoroMinutes)}:${formatTime(pomodoroSeconds)}`;
      pomodoroSessionType.textContent = pomodoroIsWorkSession ? 'Work Session' : 'Break Session';
    }

    function saveHistoryToLocalStorage() {
      const items = Array.from(historyList.children).map(li => li.textContent);
      localStorage.setItem("pomodoroHistory", JSON.stringify(items));
    }

    function loadHistory() {
      const saved = JSON.parse(localStorage.getItem("pomodoroHistory")) || [];
      saved.forEach(item => {
        const li = document.createElement("li");
        li.textContent = item;
        historyList.appendChild(li);
      });
    }

    function addToHistory(sessionType, duration) {
      const li = document.createElement("li");
      li.textContent = sessionType === "Work" 
        ? `âœ… Work Session bitti (${duration} dk)`
        : `â˜• Break Session bitti (${duration} dk)`;
      historyList.appendChild(li);
      saveHistoryToLocalStorage();
    }

    function startPomodoroTimer() {
      if (pomodoroIsActive) return;
      pomodoroIsActive = true;
      pomodoroStartBtn.disabled = true;
      pomodoroPauseBtn.disabled = false;

      pomodoroTimerInterval = setInterval(() => {
        if (pomodoroSeconds === 0) {
          if (pomodoroMinutes === 0) {
            clearInterval(pomodoroTimerInterval);
            pomodoroIsActive = false;
            pomodoroStartBtn.disabled = false;
            pomodoroPauseBtn.disabled = true;

            // ðŸ”” SÃ¼re bittiÄŸinde alarm Ã§alsÄ±n
            alarmSound.play();

            // Kaydet ve geÃ§miÅŸe ekle
            if (pomodoroIsWorkSession) {
              addToHistory("Work", configuredWorkDuration);
              pomodoroMinutes = configuredBreakDuration;
              pomodoroSeconds = 0;
              pomodoroIsWorkSession = false;
            } else {
              addToHistory("Break", configuredBreakDuration);
              pomodoroMinutes = configuredWorkDuration;
              pomodoroSeconds = 0;
              pomodoroIsWorkSession = true;
            }
          } else {
            pomodoroMinutes--;
            pomodoroSeconds = 59;
          }
        } else {
          pomodoroSeconds--;
        }
        updatePomodoroDisplay();
      }, 1000);
    }

    function pausePomodoroTimer() {
      clearInterval(pomodoroTimerInterval);
      pomodoroIsActive = false;
      pomodoroStartBtn.disabled = false;
      pomodoroPauseBtn.disabled = true;
    }

    function resetPomodoroTimer() {
      clearInterval(pomodoroTimerInterval);
      pomodoroIsActive = false;
      pomodoroIsWorkSession = true;
      pomodoroMinutes = configuredWorkDuration;
      pomodoroSeconds = 0;
      pomodoroStartBtn.disabled = false;
      pomodoroPauseBtn.disabled = true;
      updatePomodoroDisplay();
    }

    pomodoroStartBtn.addEventListener('click', startPomodoroTimer);
    pomodoroPauseBtn.addEventListener('click', pausePomodoroTimer);
    pomodoroResetBtn.addEventListener('click', resetPomodoroTimer);

    workDurationInput.addEventListener('change', (e) => {
      const val = parseInt(e.target.value);
      if (val > 0) {
        configuredWorkDuration = val;
        if (!pomodoroIsActive && pomodoroIsWorkSession) {
          pomodoroMinutes = val;
          pomodoroSeconds = 0;
          updatePomodoroDisplay();
        }
      }
    });

    breakDurationInput.addEventListener('change', (e) => {
      const val = parseInt(e.target.value);
      if (val > 0) {
        configuredBreakDuration = val;
        if (!pomodoroIsActive && !pomodoroIsWorkSession) {
          pomodoroMinutes = val;
          pomodoroSeconds = 0;
          updatePomodoroDisplay();
        }
      }
    });

    // Clear history
    clearHistoryBtn.addEventListener('click', () => {
      historyList.innerHTML = "";
      localStorage.removeItem("pomodoroHistory");
    });

    window.onload = function() {
      updatePomodoroDisplay();
      loadHistory();
    };
  </script>
</body>
</html>